=== Step 1/3: Generate matched annotations ===

Processing batch 1/13 [0:30]

Processing batch 2/13 [30:60]

Processing batch 3/13 [60:90]

Processing batch 4/13 [90:120]

Processing batch 5/13 [120:150]

Processing batch 6/13 [150:180]

Processing batch 7/13 [180:210]

Processing batch 8/13 [210:240]

Processing batch 9/13 [240:270]

Processing batch 10/13 [270:300]

Processing batch 11/13 [300:330]

Processing batch 12/13 [330:360]

Processing batch 13/13 [360:370]

Processed 370 image pairs in 13 batches.
Pipeline completed.
=== Step 2/3: Train DETR (Option 2 pixel diff, processor-based) ===
Epoch 1/20: train_loss=2.5215 val_loss=2.2607 val_prec=0.000 val_rec=0.000
Saved best checkpoint -> /scratch/hbm9834/Computer_vision/Assignment3/outputs/checkpoints/detr_option2_all_best.pth
Epoch 2/20: train_loss=2.1198 val_loss=2.0213 val_prec=0.000 val_rec=0.000
Saved best checkpoint -> /scratch/hbm9834/Computer_vision/Assignment3/outputs/checkpoints/detr_option2_all_best.pth
Epoch 3/20: train_loss=1.7311 val_loss=1.7619 val_prec=0.000 val_rec=0.000
Saved best checkpoint -> /scratch/hbm9834/Computer_vision/Assignment3/outputs/checkpoints/detr_option2_all_best.pth
Epoch 4/20: train_loss=1.6101 val_loss=1.6323 val_prec=0.000 val_rec=0.000
Saved best checkpoint -> /scratch/hbm9834/Computer_vision/Assignment3/outputs/checkpoints/detr_option2_all_best.pth
Epoch 5/20: train_loss=1.4709 val_loss=1.4821 val_prec=0.000 val_rec=0.000
Saved best checkpoint -> /scratch/hbm9834/Computer_vision/Assignment3/outputs/checkpoints/detr_option2_all_best.pth
Epoch 6/20: train_loss=1.3634 val_loss=1.4213 val_prec=0.000 val_rec=0.000
Saved best checkpoint -> /scratch/hbm9834/Computer_vision/Assignment3/outputs/checkpoints/detr_option2_all_best.pth
Epoch 7/20: train_loss=1.3059 val_loss=1.4606 val_prec=0.000 val_rec=0.000
Epoch 8/20: train_loss=1.2578 val_loss=1.4597 val_prec=0.000 val_rec=0.000
Epoch 9/20: train_loss=1.3023 val_loss=1.4840 val_prec=0.000 val_rec=0.000
Epoch 10/20: train_loss=1.2582 val_loss=1.3807 val_prec=0.000 val_rec=0.000
Saved best checkpoint -> /scratch/hbm9834/Computer_vision/Assignment3/outputs/checkpoints/detr_option2_all_best.pth
Epoch 11/20: train_loss=1.1783 val_loss=1.3648 val_prec=0.000 val_rec=0.000
Saved best checkpoint -> /scratch/hbm9834/Computer_vision/Assignment3/outputs/checkpoints/detr_option2_all_best.pth
Epoch 12/20: train_loss=1.1397 val_loss=1.2618 val_prec=0.000 val_rec=0.000
Saved best checkpoint -> /scratch/hbm9834/Computer_vision/Assignment3/outputs/checkpoints/detr_option2_all_best.pth
Epoch 13/20: train_loss=1.0764 val_loss=1.2183 val_prec=0.000 val_rec=0.000
Saved best checkpoint -> /scratch/hbm9834/Computer_vision/Assignment3/outputs/checkpoints/detr_option2_all_best.pth
Epoch 14/20: train_loss=1.0297 val_loss=1.1919 val_prec=0.000 val_rec=0.000
Saved best checkpoint -> /scratch/hbm9834/Computer_vision/Assignment3/outputs/checkpoints/detr_option2_all_best.pth
Epoch 15/20: train_loss=1.0326 val_loss=1.1691 val_prec=0.000 val_rec=0.000
Saved best checkpoint -> /scratch/hbm9834/Computer_vision/Assignment3/outputs/checkpoints/detr_option2_all_best.pth
Epoch 16/20: train_loss=0.9979 val_loss=1.1934 val_prec=0.000 val_rec=0.000
Epoch 17/20: train_loss=1.0033 val_loss=1.1853 val_prec=0.250 val_rec=0.025
Epoch 18/20: train_loss=0.9984 val_loss=1.2087 val_prec=0.462 val_rec=0.050
Epoch 19/20: train_loss=0.9653 val_loss=1.2338 val_prec=0.333 val_rec=0.075
Epoch 20/20: train_loss=0.9465 val_loss=1.2198 val_prec=0.167 val_rec=0.125
Best val_loss=1.1691 at /scratch/hbm9834/Computer_vision/Assignment3/outputs/checkpoints/detr_option2_all_best.pth
=== Step 3/3: Run ablations (loss/prec/rec) + final eval ===
