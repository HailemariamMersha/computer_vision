Device: cuda
Training set: torch.Size([48000, 1, 28, 28]), torch.Size([48000])
Validation set: torch.Size([12000, 1, 28, 28]), torch.Size([12000])
Test set: torch.Size([10000, 1, 28, 28]), torch.Size([10000])
Device: cuda

[Linear] forward/backward numeric grad...
  max |dL/dx (num - analytic)|: 6.458163261413574e-05
  max |dL/dW (num - analytic)|: 5.84721565246582e-05
  max |dL/db (num - analytic)|: 0.00011307001113891602
  PASS

[ReLU] forward/backward numeric grad...
  max |dL/dx| diff: 0.00018703937530517578
  PASS

[CrossEntropy] forward/backward numeric grad wrt logits...
  max |dL/dlogits| diff: 0.00014224275946617126
  PASS

[Conv2D] forward shape check...
  PASS

[Conv2D] backward numeric grads (sampled)...
  max |dL/dx| diff: 0.000302731990814209
  max |dL/dW| diff: 0.0005027055740356445
  PASS

[MaxPool2D] forward vs F.max_pool2d...
  max |y - y_ref|: 0.0
  PASS

[MaxPool2D] backward numeric grads...
  max |dL/dx| diff: 4.225969314575195e-05
  PASS

[E2E] small CNN forward shape...
  PASS

[E2E] tiny training sanity: loss should drop...
  epoch1: loss=2.2132, acc=0.055
  epoch2: loss=1.9467, acc=0.266
  PASS

ALL TESTS PASSED (within numeric tolerances)
Device: cuda
Training set: torch.Size([48000, 1, 28, 28]), torch.Size([48000])
Validation set: torch.Size([12000, 1, 28, 28]), torch.Size([12000])
Test set: torch.Size([10000, 1, 28, 28]), torch.Size([10000])
CNN from Scratch - Assignment
==================================================
Building CNN...
Starting training...
Total parameters: 9098
Epoch 01 | train loss 0.8058 acc 0.7670 | val loss 0.3285 acc 0.9045
Epoch 02 | train loss 0.2669 acc 0.9220 | val loss 0.2370 acc 0.9303
Epoch 03 | train loss 0.2000 acc 0.9411 | val loss 0.1913 acc 0.9433
Epoch 04 | train loss 0.1644 acc 0.9526 | val loss 0.1694 acc 0.9493
Epoch 05 | train loss 0.1416 acc 0.9588 | val loss 0.1414 acc 0.9573

Final Test Results: loss 0.1183 | acc 0.9647
